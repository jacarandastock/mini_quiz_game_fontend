import{d as K,r as k,o as W,e as s,f,g as X,w as t,k as e,m as d,j as l,i as w,F as L,q as N,h as i,t as u,x as Y,l as q,p,y as F}from"./index-50f4d373.js";const Z=l("h3",null,"Rank",-1),ee=l("thead",null,[l("tr",null,[l("th",{class:"text-left"}," Rank "),l("th",{class:"text-left"}," Username "),l("th",{class:"text-left"}," Score ")])],-1),te=l("h3",null,"Records",-1),le=l("thead",null,[l("tr",null,[l("th",{class:"text-left"}," id "),l("th",{class:"text-left"}," User "),l("th",{class:"text-left"}," Question "),l("th",{class:"text-left"}," Answer "),l("th",{class:"text-left"}," Score "),l("th",{class:"text-left"}," Answer Stage "),l("th",{class:"text-left"}," Time ")])],-1),ne=K({__name:"admin",setup(ae){const v=k([]),C=k([]),g=k(""),T=[{title:"Username",key:"username",align:"start"},{title:"Password",key:"password"},{title:"isAdmin",key:"isAdmin"}],_=k(!1);function $(n,a){return n.toString().toLowerCase().indexOf(a)!==-1}async function j(){console.log("start game");const n=await p.post("/admin/game/start");alert(n.data.message)}async function z(){if(confirm("确定要重置游戏吗？")){console.log("reset game");const a=await p.post("/admin/game/reset");alert(a.data.message)}}async function y(){console.log("get all records");const n=await p.post("/admin/game/record");console.log(n),v.value=n.data.data}async function S(){console.log("get all user");const n=await p.post("/admin/users");console.log(n),C.value=n.data.data}async function E(){console.log("clear record");const n=await p.post("/admin/game/record_clear");_.value=!1,console.log(n)}W(()=>{y(),S(),setInterval(()=>{y(),console.log("update records")},1e4)});function H(n){let a=0;for(let o=0;o<n.length;o++)a=n.charCodeAt(o)+((a<<5)-a);const r=(a&16777215).toString(16).toUpperCase();return"#"+"00000".substring(0,6-r.length)+r}function I(n){if(n===void 0||n.length===0)return[];let a={};for(let o=0;o<n.length;o++)a[n[o].username]===void 0&&(a[n[o].username]=0),a[n[o].username]+=n[o].score;let r=[];for(let o in a)r.push([o,a[o]]);return r.sort((o,x)=>x[1]-o[1]),r}return(n,a)=>{const r=s("v-btn"),o=s("v-col"),x=s("v-card-title"),V=s("v-table"),h=s("v-card"),b=s("v-icon"),R=s("v-spacer"),U=s("v-toolbar"),A=s("v-expansion-panel-title"),B=s("v-expansion-panel-text"),G=s("v-expansion-panel"),D=s("v-expansion-panels"),M=s("v-text-field"),O=s("v-data-table"),P=s("v-row"),Q=s("v-dialog"),J=s("v-container");return f(),X(J,{class:"fill-height"},{default:t(()=>[e(P,null,{default:t(()=>[e(o,{cols:"12"},{default:t(()=>[e(r,{onClick:j,class:"mr-2"},{default:t(()=>[d("Game Start")]),_:1}),e(r,{onClick:z,color:"red-accent-4"},{default:t(()=>[d("Reset Game")]),_:1})]),_:1}),e(o,{cols:"12"},{default:t(()=>[e(h,null,{default:t(()=>[e(x,null,{default:t(()=>[Z]),_:1}),e(V,null,{default:t(()=>[ee,l("tbody",null,[(f(!0),w(L,null,N(I(i(v)),(c,m)=>(f(),w("tr",{key:m},[l("td",null,u(m+1),1),l("td",null,u(c[0]),1),l("td",null,u(c[1]),1)]))),128))])]),_:1})]),_:1})]),_:1}),e(o,{cols:"12"},{default:t(()=>[e(h,null,{default:t(()=>[e(x,null,{default:t(()=>[te]),_:1}),e(U,null,{default:t(()=>[e(r,{icon:"",onClick:a[0]||(a[0]=c=>_.value=!0)},{default:t(()=>[e(b,null,{default:t(()=>[d("mdi-delete")]),_:1})]),_:1}),e(R),e(r,{icon:"",onClick:y},{default:t(()=>[e(b,null,{default:t(()=>[d("mdi-refresh")]),_:1})]),_:1})]),_:1}),e(V,null,{default:t(()=>[le,l("tbody",null,[(f(!0),w(L,null,N(i(v),(c,m)=>(f(),w("tr",{key:m},[l("td",null,u(m),1),l("td",null,[l("mark",{style:Y("background-color:"+H(c.username))},u(c.username),5)]),l("td",null,u(c.question),1),l("td",null,u(c.answer),1),l("td",null,u(c.score),1),l("td",null,u(c.stage),1),l("td",null,u(new Date(c.timestamp*1e3).toLocaleString()),1)]))),128))])]),_:1}),e(D,null,{default:t(()=>[e(G,null,{default:t(()=>[e(A,{"expand-icon":"mdi-menu-down"}),e(B,null,{default:t(()=>[d(u(i(v)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(o,{cols:"12"},{default:t(()=>[e(D,{class:"mb-6"},{default:t(()=>[e(G,null,{default:t(()=>[e(A,{"expand-icon":"mdi-menu-down"},{default:t(()=>[d(" 用户管理 ")]),_:1}),e(B,null,{default:t(()=>[e(h,{elevation:"0"},{default:t(()=>[e(U,null,{default:t(()=>[e(R),e(r,{icon:"",onClick:S},{default:t(()=>[e(b,null,{default:t(()=>[d("mdi-refresh")]),_:1})]),_:1})]),_:1}),e(O,{"custom-filter":$,headers:T,items:i(C),search:i(g),"item-value":"name"},{top:t(()=>[e(M,{modelValue:i(g),"onUpdate:modelValue":a[1]||(a[1]=c=>q(g)?g.value=c:null),class:"pa-2",label:"Search User"},null,8,["modelValue"])]),_:1},8,["items","search"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(Q,{modelValue:i(_),"onUpdate:modelValue":a[3]||(a[3]=c=>q(_)?_.value=c:null),width:"auto"},{default:t(()=>[e(h,{"max-width":"400","prepend-icon":"mdi-alert",text:"你确定要清空所有记录吗？",title:"警告！"},{actions:t(()=>[e(r,{class:"ms-auto",text:"取消",type:"primary",onClick:a[2]||(a[2]=c=>_.value=!1)}),e(r,{class:"ms-2",text:"确定",color:"error",onClick:E})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}});typeof F=="function"&&F(ne);export{ne as default};
